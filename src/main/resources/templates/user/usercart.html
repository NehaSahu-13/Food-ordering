<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="user/user-base::layout(~{::section})">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
   <section>
   
      <div class="cart-wrapper">
      
         
       <div th:if="${cartItems}" >
           
           <div class="d-flex flex-column rest-container food-container cart-item">
           
           <div th:each="r:${cartItems}" class="card rest-card cardborder mb-5 order-card" style="min-width: 220px">
           
               <div class='card-body d-flex flex-wrap'>
               
                 <div>
                   <img src="" th:src="'/img/'+${r.food.images}" class="rest-img"/>
                 </div>
                 <div class="mx-5">
                   <h5 class="mt-2" th:text="${r.food.name}"></h5>
                   <h5 th:text="'Rs.'+${r.totalprice}"></h5>
                   <h6 th:text="'By '+${r.food.restaurant.name}"></h6>
                   <div th:text="${r.food.restaurant.address.StreetAddress}"></div>
                 </div>
                 <div class="mx-5 text-center quantity-cart">
                     <h6 class="mt-5" th:text="'Quantity : '+${r.quantity}"></h6>
                       <form method="post" th:action="@{'/customer/update-cartItem/'+${r.id}}">
                    	<span onclick="subtract(this)" class=" fw-bold fs-3 text-success outline-none">-</span>
                    	<input type="text" th:value="${r.quantity}" name="quantity" class="quantity-ele text-center" />
                    	<span onclick="add(this)" class=" fw-bold fs-4 text-success">+</span>
                    	  <button type="submit" class="d-none" id="update-cart-form"></button>
	                    </form>
                   </div>
                <a class='mt-5 ms-5' th:href="@{'/customer/removecartItem/'+${r.id}}">
                    <button class="btn btn-success">Remove</button>
                 </a>
               
            
           </div>
           
           </div>
           
           
           
    
       </div>
       
       
          <footer th:if="${#lists.size(cartItems) > 0}" class="card bill-container mt-5">
              <div class='card-body bill-subcont'>
              
                 <h5 class="bill">Bill Details</h5>
                 
              <div class="d-flex flex-row bill-details flex-wrap">
               
                  <div class="d-flex flex-column" style="gap:1em;">
                      <div class="d-flex justify-content-between" style="gap:2em;">
                          <div>Item Total</div>
                          <div th:text="'Rs.'+${cart.total}"></div>
                      </div>
                      <div class="d-flex justify-content-between" style="gap:2em;">
                         <div>Delivery Fee</div>
                         <div>Rs.37</div>
                      </div>
                      <div>
                      
                      </div>
                  </div>
                  <div class="d-flex flex-column"style="gap:1em;">
                      <div class="d-flex justify-content-between" style="gap:2em;">
                          <div>Platform Fee</div>
                          <div>Rs.5</div>
                      </div>
                      <div class="d-flex justify-content-between" style="gap:2em;">
                         <div>GST and Restaurant Charges</div>
                         <div>Rs.35.05</div>
                      </div>
                      <div>
                      
                      </div>
                  </div>
                  <div class="d-flex flex-column" style="gap:1em;">
                      <div class="d-flex justify-content-between" style="gap:2em;">
                          <div>To Pay</div>
                          <div th:text="5+37+35.05+${cart.total}"></div>
                      </div>
                      <div class="d-flex justify-content-between" style="gap:2em;">
                         <a th:href="@{/customer/deliveryform}"><button  class="btn btn-success ps-5 pe-5">Proceed</button></a>
                      </div>
                      <div>
                      
                      </div>
                  </div>
                 </div>
              </div>
          </footer>
       </div>
       
       </div>
    

       <div th:if="${#lists.isEmpty(cartItems)}" class="text-center">
       <img src="/img/empty-cart.png" style='height:300px'/>
       <h3 class=" fw-light" >Your Cart is Empty ....</h3> 
       
       </div>
       
     
          
    </div>  
      
    <script>
    function subtract(button){
 		let parent = button.parentElement;
 		quantity = parent.querySelector("input");
 		 quant = parseInt(quantity.value);
 		 if(quant > 1){
 			quant = quant - 1;
 			 quantity.value = quant;
 			submitForm(button);
 		 }
 	 }
 	 
 	function add(button){
 		let parent = button.parentElement;
 		quantity = parent.querySelector("input");
 		 quant = parseInt(quantity.value);
 		 if(quant < 20){
 			quant = quant + 1;
 			 quantity.value = quant;
 			  submitForm(button);
 		 }
 	 }
 	
 	function submitForm(button) {
 	    const form = button.closest('form');
 	    form.querySelector('#update-cart-form').click();
 	}
 	
 	 $(document).ready(()=>{
    	 $('.item').removeClass('active');
    	 $("#cart").addClass("active");
    })
 	
    </script>
       
    
   </section>
</body>
</html>